# Architecture Overview

## High-Level Design

This lab simulates a small healthcare environment deployed in Microsoft Azure. The goal is to combine **cloud administration (AZ-104)** with **security monitoring and analysis (CySA+)**.

### Azure Resources

- **Resource Group**
  - `rg-hc-sec-lab` – Contains all lab resources.

- **Networking**
  - **Virtual Network:** `vnet-hc-sec-lab`
    - Address space: `10.10.0.0/16`
    - Subnets:
      - `subnet-app` (`10.10.1.0/24`) – Application/workload subnet
      - `subnet-security` (`10.10.2.0/24`) – Reserved for future security tools

- **Application Layer**
  - Azure App Service *or* a Linux VM hosting a simple "healthcare portal" web app.
  - The app includes:
    - A login page
    - A page that lists fake patient or prescription data

- **Data Layer**
  - Azure SQL Database or Azure Storage (tables/blobs) containing mock healthcare data.
  - Secrets such as connection strings are stored in **Azure Key Vault**.
  - The application uses a **managed identity** to access Key Vault.

- **Security and Monitoring**
  - **Azure Log Analytics Workspace:** `law-hc-sec-lab`
    - Collects logs from the app, Azure resources, and security tools.
  - **Microsoft Defender for Cloud**
    - Provides security recommendations and alerts for Azure resources.
  - **Microsoft Sentinel**
    - Connected to the Log Analytics workspace for:
      - Correlation
      - Detection rules
      - Incidents
      - Threat hunting with KQL

## Attack Simulation Setup

- **Blue Team Machine**
  - Primary desktop used to administer Azure, monitor Sentinel, and perform analysis.

- **Red Team Machine**
  - Second desktop (or VM) used to simulate attacker activity such as:
    - Port scanning
    - Repeated login failures
    - Web probing and basic enumeration

The traffic generated by the "attacker" machine is intended to show up in logs and trigger **Microsoft Sentinel** detections and incidents.

## Future Enhancements

- Add an Azure Firewall or WAF in front of the web app.
- Implement private endpoints and restrict public access.
- Create automated response playbooks (Logic Apps) to:
  - Block malicious IPs
  - Notify the administrator when incidents occur.
